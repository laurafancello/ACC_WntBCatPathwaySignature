## ACC_WntBCatPathwaySignature
In order to use scripts it is required to set as working directory this repository using the following command:  
setwd(<path_to_repository>)  

## Data folders 
The following folders contains the output of the scripts:
- ACC_datasets_formatted  
- ACC_datasets_integration  
- BoxplotsGeneExpression  
- DEanalyses_ACC  
- Pancancer  
- SignatureAndLEF1_inACC
  
The folder "ACC_datasets_formatted" also contains some required input.  
Note that the output of some scripts is the required input of other scripts.  

## Scripts folder
Contains the code used througout the analysis

### Environment.txt
Version for all R packages used.  

### Fig1AC_SuppFigS3_LEF1orBcatSignatureDistributions_perBcatStatus.R
Script to generate main Figure 1A and 1C, and Supplementary Figure 3.  
It plots the expression of LEF1 or of the signature in function of the known activation status of the Wnt/B-Catenin pathway (based on CTNNB1 mutations or B-Catenin protein nuclear localization).
It also quantifies the classification performance of LEF1 or signature expression as AUC-ROC values.  
The signature is the transcriptional signature built as marker of Wnt/B-Catenin pathway activation in ACC.  

### Fig1B_CollectAndHeatmap_BCateninTargetWilcoxonPvalues.R
Script to generate main Figure 1B.  
For each known B-Catenin transcriptional target it compares its expression depending on the known activation status of the Wnt/B-Catenin pathway (based on CTNNB1 mutations or B-Catenin protein nuclear localization).
It provides fold changes and estimates p-values using the Wilcoxon test (or T-test for the Lefevre dataset given n=3 in each group).  

### Fig2_BcateninSignature_LEF1_correlation_vs_KnownPathwayStatus.R
Script to generate main Figure 2.  
It correlates LEF1 and signature expression across tumors for each dataset. Data points (tumors) are colored by the known activation status of the Wnt/B-Catenin pathway (based on CTNNB1 mutations or B-Catenin protein nuclear localization). Their shape represents tumor aggressiveness (in terms of 5 years overall survival).  

### Fig3A_SuppFigS7A_Corr_BcatSignature_Gene_ZscoreIntegrated.R
Script to generate main Figure 3A and Supplementary Figure 7A.  
Requires as input the unique dataset consisting in the 6 merged transcriptomes after Z-score transformation generated by SuppFigS5_ZscoreNormalize_ACCdatasets.R  
It calculates Pearson correlations between each measured gene and the signature, using a unique dataset consisting in the 6 merged transcriptomes after Z-score transformation.  
Then it calculates GSEA on genes ranked by their correlation value.  
For Supplementary Figure 7A it plots the heatmap of expression of genes from the leading edge of the Hallmarks Inflammatory Response gene set (from above-mentioned GSEAs).  

### Fig3B_4CD_SuppFigS1_S6AB_S8_BoxplotsGeneExpression.R
Script to generate main Figure 3B, 4C and 4D and Supplementary Figure 1, 6A, 6B and 8.  
It generates boxplots of expression of various genes of interest depending on the known activation status of the Wnt/B-Catenin pathway (based on CTNNB1 mutations or B-Catenin protein nuclear localization).  

### Fig3E_SuppFigS7C_Boxplots_Signature_Glucocorticoids_ImmuneResponse.R
Script to generate main Figure 3E and Supplementary Figure 7C.  
It generates boxplots of average expression of inflammatory response genes and other immune-response related genes depending on the signature levels and presence/absence of cortisol excess.  
Requires as input the unique dataset consisting in the 6 merged transcriptomes after Z-score transformation generated by SuppFigS5_ZscoreNormalize_ACCdatasets.R   
Immune-response genes are those in the leading edge of significantly enriched immune-related gene sets identified by GSEAs performed by the Fig3A_SuppFigS7A_Corr_BcatSignature_Gene_ZscoreIntegrated.R script.  

## Fig4A_Analysis_CandidateNewBCateninTargets_ZscoreIntegratedData.R
Script to generate main Figure 4A.  
Requires as input the unique dataset consisting in the 6 merged transcriptomes after Z-score transformation generated by SuppFigS5_ZscoreNormalize_ACCdatasets.R  
It identifies candidate novel β-Catenin transcriptional targets as genes satisfying the following criteria: i. Pearson correlation with signature expression higher than 0.5, ii. presence of a transcription factor binding site recognized by the TCF/LEF complex or a ChIP-Seq peak for the TCF/LEF complex (based on input from iRegulon analysis), iii. significantly reduced (FDR<0.1) expression in the H295R cell line following β-Catenin inactivation by shRNA (limma-based differential expression analysis reported in Supplementary Table 1 of the original paper associated to the Lefevre dataset). 

### SuppFigS2_DEanalysis_LEF1orSignatureBased_Assie.R
Script to generate Supplementary Figure 2.  
It performs differential expression analysis on Assie dataset tumors grouped by LEF1 or signature expression (median cutoff)

### SuppFigS2_DEanalysis_LEF1orSignatureBased_Heaton.R
Script to generate Supplementary Figure 2.  
It performs differential expression analysis on Heaton dataset tumors grouped by LEF1 or signature expression (median cutoff)  

### SuppFigS2_DEanalysis_LEF1orSignatureBased_TCGA.R
Script to generate Supplementary Figure 2.  
It performs differential expression analysis on TCGA dataset tumors grouped by LEF1 or signature expression (median cutoff)

### SuppFigS4_PancancerAnalysis.R  
Script to generate Supplementary Figure 4.  

### SuppFigS5_ZscoreNormalize_ACCdatasets.R
Script to generate Supplementary Figure 5.  
First, it generates unique dataset consisting in the 6 merged transcriptomes after Z-score transformation.  
Then, it plots PCAs to verify if any batch effects (by dataset origin, technology, micorarray platform)

### SuppFigS6DE_S7B_GSEA_CTNNB1mutVsWt.R
Script to generate Supplementary Figure 6D, 6E, 7B.  
It performs GSEAs on fold changes between tumors with CTNNB1 mutation (or B-Catenin protein nuclear localization) and tumors with CTNNB1 wt  (or B-Catenin protein membrane localization)  

### SuppTable4_DEanalysis_CTNNB1mutVsWt_Assie.R
Script to generate Supplementary Table 4.
It performs differential expression analysis on Assie dataset between tumors with CTNNB1 mutation and tumors with CTNNB1 wt  
It the performs the same analysis after removing five potentially miscalssified tumors (CTNNB1 wild type but high LEF1 and signature expression), which allows to recover some significantly upregulated B-Catenin targets (which is not the case using all tumors)  



